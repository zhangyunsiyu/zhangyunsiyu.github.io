<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>《小程序云开发》 | zhangyun&#39;s blog</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="manifest" href="/photo.jpg">
    <link rel="apple-touch-icon" href="/photo.jpg">
    <meta name="description" content="张赟的个人博客">
    <link rel="preload" href="/assets/css/0.styles.3ef2f377.css" as="style"><link rel="preload" href="/assets/js/app.a588af55.js" as="script"><link rel="preload" href="/assets/js/2.f38c671b.js" as="script"><link rel="preload" href="/assets/js/3.ec2fcfa1.js" as="script"><link rel="prefetch" href="/assets/js/10.41bb317e.js"><link rel="prefetch" href="/assets/js/11.5ea85ae7.js"><link rel="prefetch" href="/assets/js/12.5df3dc35.js"><link rel="prefetch" href="/assets/js/13.99c90dd9.js"><link rel="prefetch" href="/assets/js/14.b4ffd24b.js"><link rel="prefetch" href="/assets/js/15.060b7f73.js"><link rel="prefetch" href="/assets/js/16.72b4a87f.js"><link rel="prefetch" href="/assets/js/17.e1c78016.js"><link rel="prefetch" href="/assets/js/18.737dd990.js"><link rel="prefetch" href="/assets/js/19.17f9ec77.js"><link rel="prefetch" href="/assets/js/20.d903e60f.js"><link rel="prefetch" href="/assets/js/21.35b51d19.js"><link rel="prefetch" href="/assets/js/22.1d209a45.js"><link rel="prefetch" href="/assets/js/4.22317258.js"><link rel="prefetch" href="/assets/js/5.1ccf4a00.js"><link rel="prefetch" href="/assets/js/6.57b9c421.js"><link rel="prefetch" href="/assets/js/7.55d11316.js"><link rel="prefetch" href="/assets/js/8.50177506.js"><link rel="prefetch" href="/assets/js/9.ae4844c1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3ef2f377.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">zhangyun's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端总结" class="dropdown-title"><span class="title">前端总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontEnd/WEB/" class="nav-link">
  WEB基础
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/JavaScript/" class="nav-link">
  JavaScript笔记
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/Vue/" class="nav-link">
  Vue笔记
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/React/" class="nav-link">
  React笔记
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="小程序总结" class="dropdown-title"><span class="title">小程序总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/miniApp/wechatApp/" class="nav-link router-link-active">
  微信小程序
</a></li><li class="dropdown-item"><!----> <a href="/miniApp/alipayApp/" class="nav-link">
  支付宝小程序
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="服务端总结" class="dropdown-title"><span class="title">服务端总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/serveEnd/NodeJs/" class="nav-link">
  NodeJs
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="混合app" class="dropdown-title"><span class="title">混合app</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/app/cordova/" class="nav-link">
  cordova
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="感动常在" class="dropdown-title"><span class="title">感动常在</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mySpace/essay/" class="nav-link">
  读书笔记
</a></li><li class="dropdown-item"><!----> <a href="/mySpace/photo/" class="nav-link">
  摄影随笔
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端总结" class="dropdown-title"><span class="title">前端总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontEnd/WEB/" class="nav-link">
  WEB基础
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/JavaScript/" class="nav-link">
  JavaScript笔记
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/Vue/" class="nav-link">
  Vue笔记
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/React/" class="nav-link">
  React笔记
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="小程序总结" class="dropdown-title"><span class="title">小程序总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/miniApp/wechatApp/" class="nav-link router-link-active">
  微信小程序
</a></li><li class="dropdown-item"><!----> <a href="/miniApp/alipayApp/" class="nav-link">
  支付宝小程序
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="服务端总结" class="dropdown-title"><span class="title">服务端总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/serveEnd/NodeJs/" class="nav-link">
  NodeJs
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="混合app" class="dropdown-title"><span class="title">混合app</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/app/cordova/" class="nav-link">
  cordova
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="感动常在" class="dropdown-title"><span class="title">感动常在</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mySpace/essay/" class="nav-link">
  读书笔记
</a></li><li class="dropdown-item"><!----> <a href="/mySpace/photo/" class="nav-link">
  摄影随笔
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>微信小程序</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/miniApp/wechatApp/" class="sidebar-link">写在前面</a></li><li><a href="/miniApp/wechatApp/note.html" class="sidebar-link">《微信小程序实战笔记》</a></li><li><a href="/miniApp/wechatApp/wechatCloud.html" class="active sidebar-link">《小程序云开发》</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/miniApp/wechatApp/wechatCloud.html#概述" class="sidebar-link">概述 :</a></li><li class="sidebar-sub-header"><a href="/miniApp/wechatApp/wechatCloud.html#创建项目" class="sidebar-link">创建项目:</a></li><li class="sidebar-sub-header"><a href="/miniApp/wechatApp/wechatCloud.html#开通云服务" class="sidebar-link">开通云服务:</a></li><li class="sidebar-sub-header"><a href="/miniApp/wechatApp/wechatCloud.html#概览：查看云开发基础使用数据" class="sidebar-link">概览：查看云开发基础使用数据</a></li><li class="sidebar-sub-header"><a href="/miniApp/wechatApp/wechatCloud.html#基础方法-基本涵盖小程序云开发常用的定义和方法" class="sidebar-link">基础方法(基本涵盖小程序云开发常用的定义和方法):</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/miniApp/wechatApp/wechatCloud.html#小程序调用云函数示例" class="sidebar-link">小程序调用云函数示例:</a></li><li class="sidebar-sub-header"><a href="/miniApp/wechatApp/wechatCloud.html#小程序调用数据库示例" class="sidebar-link">小程序调用数据库示例:</a></li><li class="sidebar-sub-header"><a href="/miniApp/wechatApp/wechatCloud.html#小程序存储调用示例" class="sidebar-link">小程序存储调用示例:</a></li><li class="sidebar-sub-header"><a href="/miniApp/wechatApp/wechatCloud.html#云函数的定义" class="sidebar-link">云函数的定义:</a></li><li class="sidebar-sub-header"><a href="/miniApp/wechatApp/wechatCloud.html#云函数中操作数据库" class="sidebar-link">云函数中操作数据库</a></li></ul></li><li class="sidebar-sub-header"><a href="/miniApp/wechatApp/wechatCloud.html#云开发实践" class="sidebar-link">云开发实践:</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/miniApp/wechatApp/wechatCloud.html#_1-需求分析" class="sidebar-link">1: 需求分析:</a></li><li class="sidebar-sub-header"><a href="/miniApp/wechatApp/wechatCloud.html#_2-项目构建" class="sidebar-link">2: 项目构建</a></li><li class="sidebar-sub-header"><a href="/miniApp/wechatApp/wechatCloud.html#_3-建立集合" class="sidebar-link">3: 建立集合</a></li><li class="sidebar-sub-header"><a href="/miniApp/wechatApp/wechatCloud.html#_4-核心功能的实现-以云函数操作数据库为主" class="sidebar-link">4: 核心功能的实现(以云函数操作数据库为主)</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="概述"><a href="#概述" class="header-anchor">#</a> 概述 :</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>开发者可以使用云开发开发微信小程序、小游戏，无需搭建服务器，即可使用云端能力。</li> <li>云开发为开发者提供完整的云端支持，弱化后端和运维概念，无需搭建服务器，使用平台提供的 API 进行核心业务开发，即可实现快速上线和迭代，同时这一能力，同开发者已经使用的云服务相互兼容，并不互斥。</li></ul></div> <p>目前提供三大基础能力支持：</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>云函数：在云端运行的代码，微信私有协议天然鉴权，开发者只需编写自身业务逻辑代码</li> <li>数据库：一个既可在小程序前端操作，也能在云函数中读写的 JSON 数据库</li> <li>存储：在小程序前端直接上传/下载云端文件，在云开发控制台可视化管理</li></ul></div> <h2 id="创建项目"><a href="#创建项目" class="header-anchor">#</a> 创建项目:</h2> <p>新建项目选择一个空目录，填入 AppID（使用云开发能力必须填写 AppID），勾选创建 “云开发 QuickStart 项目”，点击创建即可得到一个展示云开发基础能力的示例小程序。
项目结构如下:
<img src="/assets/img/1.c771c704.png" alt=""></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>cloudfunctions: 存放云函数
miniprogram: 存放小程序文件</p></div> <h2 id="开通云服务"><a href="#开通云服务" class="header-anchor">#</a> 开通云服务:</h2> <p><img src="/assets/img/2.af448f8d.png" alt=""></p> <p>点击云开发 , 打开云开发控制台,云开发控制台提供如下能力(云函数中对数据库的操作等同于在控制台直接操作数据库)</p> <h2 id="概览：查看云开发基础使用数据"><a href="#概览：查看云开发基础使用数据" class="header-anchor">#</a> 概览：查看云开发基础使用数据</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>用户管理：查看小程序用户信息</li> <li>数据库：管理数据库，可查看、增加、更新、查找、删除数据、管理索引、管理数据库访问权限等</li> <li>存储管理：查看和管理存储空间</li> <li>云函数：查看云函数列表、配置、日志和监控</li> <li>统计分析：查看云开发资源具体使用统计信息</li></ul></div> <h2 id="基础方法-基本涵盖小程序云开发常用的定义和方法"><a href="#基础方法-基本涵盖小程序云开发常用的定义和方法" class="header-anchor">#</a> 基础方法(基本涵盖小程序云开发常用的定义和方法):</h2> <h3 id="小程序调用云函数示例"><a href="#小程序调用云函数示例" class="header-anchor">#</a> 小程序调用云函数示例:</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Callback 风格调用</span>
wx<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span><span class="token function">callFunction</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 要调用的云函数名称</span>
  name<span class="token operator">:</span> <span class="token string">'add'</span><span class="token punctuation">,</span>
  <span class="token comment">// 传递给云函数的参数</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    x<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    y<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// output: res.result === 3</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// handle error</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">complete</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// Promise 风格调用</span>
wx<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span><span class="token function">callFunction</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 要调用的云函数名称</span>
  name<span class="token operator">:</span> <span class="token string">'add'</span><span class="token punctuation">,</span>
  <span class="token comment">// 传递给云函数的event参数</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    x<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    y<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// output: res.result === 3</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// handle error</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="小程序调用数据库示例"><a href="#小程序调用数据库示例" class="header-anchor">#</a> 小程序调用数据库示例:</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1. 获取数据库引用</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> wx<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 2. 构造查询语句</span>
<span class="token comment">// collection 方法获取一个集合的引用</span>
<span class="token comment">// where 方法传入一个对象，数据库返回集合中字段等于指定值的 JSON 文档。API 也支持高级的查询条件（比如大于、小于、in 等），具体见文档查看支持列表</span>
<span class="token comment">// get 方法会触发网络请求，往数据库取数据</span>
db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'books'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
publishInfo<span class="token operator">:</span> <span class="token punctuation">{</span>
country<span class="token operator">:</span> <span class="token string">'United States'</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// 输出 [{ &quot;title&quot;: &quot;The Catcher in the Rye&quot;, ... }]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="小程序存储调用示例"><a href="#小程序存储调用示例" class="header-anchor">#</a> 小程序存储调用示例:</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 让用户选择一张图片</span>
wx<span class="token punctuation">.</span><span class="token function">chooseImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">chooseResult</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token comment">// 将图片上传至云存储空间</span>
wx<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span><span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
<span class="token comment">// 指定上传到的云路径</span>
cloudPath<span class="token operator">:</span> <span class="token string">'my-photo.png'</span><span class="token punctuation">,</span>
<span class="token comment">// 指定要上传的文件的小程序临时文件路径</span>
filePath<span class="token operator">:</span> chooseResult<span class="token punctuation">.</span>tempFilePaths<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token comment">// 成功回调</span>
<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'上传成功'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="云函数的定义"><a href="#云函数的定义" class="header-anchor">#</a> 云函数的定义:</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.js 是入口文件，云函数被调用时会执行该文件导出的 main 方法</span>
<span class="token comment">// event 包含了调用端（小程序端）调用该函数时传过来的参数，同时还包含了可以通过 getWXContext 方法获取的用户登录态 `openId` 和小程序 `appId` 信息</span>
<span class="token keyword">const</span> cloud <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'wx-server-sdk'</span><span class="token punctuation">)</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">main</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>userInfo<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">}</span> <span class="token operator">=</span> event
<span class="token keyword">const</span> <span class="token punctuation">{</span><span class="token constant">OPENID</span><span class="token punctuation">,</span> <span class="token constant">APPID</span><span class="token punctuation">}</span> <span class="token operator">=</span> cloud<span class="token punctuation">.</span><span class="token function">getWXContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 这里获取到的 openId 和 appId 是可信的</span>
<span class="token keyword">const</span> sum <span class="token operator">=</span> a <span class="token operator">+</span> b

<span class="token keyword">return</span> <span class="token punctuation">{</span>
<span class="token constant">OPENID</span><span class="token punctuation">,</span>
<span class="token constant">APPID</span><span class="token punctuation">,</span>
sum
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="云函数中操作数据库"><a href="#云函数中操作数据库" class="header-anchor">#</a> 云函数中操作数据库</h3> <h4 id="以下调用获取默认环境的数据库的引用："><a href="#以下调用获取默认环境的数据库的引用：" class="header-anchor">#</a> 以下调用获取默认环境的数据库的引用：</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> cloud <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'wx-server-sdk'</span><span class="token punctuation">)</span>
cloud<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> cloud<span class="token punctuation">.</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="假设有一个环境名为-test，用做测试环境，那么可以如下获取测试环境数据库："><a href="#假设有一个环境名为-test，用做测试环境，那么可以如下获取测试环境数据库：" class="header-anchor">#</a> 假设有一个环境名为 test，用做测试环境，那么可以如下获取测试环境数据库：</h4> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">const</span> cloud <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'wx-server-sdk'</span><span class="token punctuation">)</span>
  cloud<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> testDB <span class="token operator">=</span> cloud<span class="token punctuation">.</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  env<span class="token operator">:</span> <span class="token string">'test'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="也可以通过-init-传入默认环境的方式使得获取数据库时默认是默认环境数据库："><a href="#也可以通过-init-传入默认环境的方式使得获取数据库时默认是默认环境数据库：" class="header-anchor">#</a> 也可以通过 init 传入默认环境的方式使得获取数据库时默认是默认环境数据库：</h4> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">const</span> cloud <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'wx-server-sdk'</span><span class="token punctuation">)</span>
  cloud<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  env<span class="token operator">:</span> <span class="token string">'test'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> testDB <span class="token operator">=</span> cloud<span class="token punctuation">.</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="操作集合"><a href="#操作集合" class="header-anchor">#</a> 操作集合:</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> cloud <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'wx-server-sdk'</span><span class="token punctuation">)</span>
  cloud<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> db <span class="token operator">=</span> cloud<span class="token punctuation">.</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> todosCollection <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'todos'</span><span class="token punctuation">)</span> <span class="token comment">// 获取todos集合</span>
</code></pre></div><h2 id="云开发实践"><a href="#云开发实践" class="header-anchor">#</a> 云开发实践:</h2> <p>(使用小程序云开发实现一个可以增删改查的设备管理平台)</p> <h3 id="_1-需求分析"><a href="#_1-需求分析" class="header-anchor">#</a> 1: 需求分析:</h3> <p>设备管理现状: 部门有大量安卓/苹果测试机和测试硬件设备 , 当前管理现状混乱 , 管理员使用纸质表格和excel对每次的出借情况进行记录 , 当有同事需要测试设备的时候 , 需要联系管理员 , 管理员查阅表格 , 找到最后借用人进行协调 , 并登记在册</p> <p>管理痛点:  管理员需要通过翻阅借用记录表去了解设备现状 , 并协调资源 , 增加了工作量 , 普通员工无法知道设备出借现状 , 获取设备环节复杂;</p> <p>考勤管理现状: 管理员通过excel表格汇总考勤情况 , 并逐月发送到员工邮箱 , 员工需要下载csv文件去查看考勤</p> <p>考勤管理痛点: 对于员工 , 通过查看excel十分不便</p> <p>需求总结: 普通员工通过查看设备现状 , 找到可以状态的设备 , 并汇报管理员 , 管理员通过小程序切换设备状态 , 绑定使用人 ; 管理员逐月导入考勤数据 , 员工可通过小程序查看个人考勤情况;</p> <h3 id="_2-项目构建"><a href="#_2-项目构建" class="header-anchor">#</a> 2: 项目构建</h3> <p>ui库使用iview weapp</p> <p>小程序端(前端)对数据库的操作权限是严格按照控制台中配置的权限 , 云函数则拥有所有权限(云函数中对数据库的操作等同于在云开发控制台中进行数据库操作),所以本项目中所有的关于数据库的操作都将在云函数中处理 , 小程序端只作为视图层 , 并对无权限的界面和操作进行视觉隔离</p> <h3 id="_3-建立集合"><a href="#_3-建立集合" class="header-anchor">#</a> 3: 建立集合</h3> <p>通过云函数控制台建立需要的集合 , 并将excel/json文件导入到对应的集合,  也可以直接手动建立
<img src="/assets/img/3.485a5368.png" alt=""></p> <h3 id="_4-核心功能的实现-以云函数操作数据库为主"><a href="#_4-核心功能的实现-以云函数操作数据库为主" class="header-anchor">#</a> 4: 核心功能的实现(以云函数操作数据库为主)</h3> <p><img src="data:image/png;base64,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" alt=""> <img src="/assets/img/5.5bdde7f8.png" alt=""></p> <h4 id="小程序端-app-js"><a href="#小程序端-app-js" class="header-anchor">#</a> 小程序端&gt;app.js</h4> <p>初始化云函数 , 获取已授权用户信息 , 定义需要的全局数据</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//app.js</span>
<span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">onLaunch</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> _this <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token comment">// 初始化云函数</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>wx<span class="token punctuation">.</span>cloud<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'请使用 2.2.3 或以上的基础库以使用云能力'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      wx<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        traceUser<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 获取用户信息(针对已经授权过的用户,直接获取用户信息)</span>
    wx<span class="token punctuation">.</span><span class="token function">getSetting</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>authSetting<span class="token punctuation">[</span><span class="token string">'scope.userInfo'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 已经授权，可以直接调用 getUserInfo 获取头像昵称，不会弹框</span>
          wx<span class="token punctuation">.</span><span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              _this<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>avatarUrl <span class="token operator">=</span> res<span class="token punctuation">.</span>userInfo<span class="token punctuation">.</span>avatarUrl
              _this<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userInfo <span class="token operator">=</span> res<span class="token punctuation">.</span>userInfo
              <span class="token keyword">if</span> <span class="token punctuation">(</span>_this<span class="token punctuation">.</span>userInfoCallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                _this<span class="token punctuation">.</span><span class="token function">userInfoCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>globalData <span class="token operator">=</span> <span class="token punctuation">{</span>
      userInfo<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 微信用户信息</span>
      userRole<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// 当前用户角色</span>
      registerUser<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 微信用户绑定的用户信息</span>
      userindex<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// 编辑设备和添加设备页面,index索引选择的值name</span>
      userindexId<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><span class="token comment">// 编辑设备和添加设备页面,index索引选择的值id</span>
      currentQuerys<span class="token operator">:</span> <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'iphone'</span><span class="token punctuation">,</span> <span class="token string">'android'</span><span class="token punctuation">,</span> <span class="token string">'ble'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        user<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span> <span class="token comment">// 设备管理筛选框筛选的结果</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="云函数-login-云函数条件查询云数据库"><a href="#云函数-login-云函数条件查询云数据库" class="header-anchor">#</a> 云函数 &gt; login (云函数条件查询云数据库)</h4> <p>以小程序open_id为查询条件 , 在云函数user集合中查找绑定该open_id的数据 , 为空表示该微信账号未绑定用户名</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 云函数入口文件</span>
<span class="token keyword">const</span> cloud <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'wx-server-sdk'</span><span class="token punctuation">)</span>
cloud<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 云函数入口函数</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">main</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> wxContext <span class="token operator">=</span> cloud<span class="token punctuation">.</span><span class="token function">getWXContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 调用数据库获取所有设备列表</span>
  <span class="token keyword">const</span> db <span class="token operator">=</span> cloud<span class="token punctuation">.</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 获取数据库</span>
  <span class="token keyword">const</span> _ <span class="token operator">=</span> db<span class="token punctuation">.</span>command <span class="token comment">// 获取查询指令</span>
  <span class="token keyword">const</span> usersCollection <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'users'</span><span class="token punctuation">)</span> <span class="token comment">// 获取users集合</span>
  <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> usersCollection<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    open_id<span class="token operator">:</span> wxContext<span class="token punctuation">.</span><span class="token constant">OPENID</span> <span class="token comment">// 根据唯一open_id在user集合中查找已绑定的用户</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    event<span class="token punctuation">,</span>
    data<span class="token operator">:</span> user<span class="token punctuation">,</span>
    openid<span class="token operator">:</span> wxContext<span class="token punctuation">.</span><span class="token constant">OPENID</span><span class="token punctuation">,</span>
    appid<span class="token operator">:</span> wxContext<span class="token punctuation">.</span><span class="token constant">APPID</span><span class="token punctuation">,</span>
    unionid<span class="token operator">:</span> wxContext<span class="token punctuation">.</span><span class="token constant">UNIONID</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="云函数-register-云函数修改数据库数据"><a href="#云函数-register-云函数修改数据库数据" class="header-anchor">#</a> 云函数 &gt; register (云函数修改数据库数据)</h4> <p>对于未绑定的微信号 , 需要将用户选中的用户名与当前微信open_id绑定 , 完成注册</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 云函数入口文件</span>
<span class="token keyword">const</span> cloud <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'wx-server-sdk'</span><span class="token punctuation">)</span>
cloud<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 云函数入口函数</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">main</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> wxContext <span class="token operator">=</span> cloud<span class="token punctuation">.</span><span class="token function">getWXContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 调用数据库获取所有设备列表</span>
  <span class="token keyword">const</span> db <span class="token operator">=</span> cloud<span class="token punctuation">.</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 获取数据库</span>
  <span class="token keyword">const</span> _ <span class="token operator">=</span> db<span class="token punctuation">.</span>command <span class="token comment">// 获取查询指令</span>
  <span class="token keyword">const</span> usersCollection <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'users'</span><span class="token punctuation">)</span> <span class="token comment">// 获取users集合</span>
  <span class="token comment">// 查询条件</span>
  <span class="token keyword">let</span> query <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
  <span class="token comment">// </span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> usersCollection<span class="token punctuation">.</span><span class="token function">doc</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// data 传入需要局部更新的数据</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span>
        open_id<span class="token operator">:</span> wxContext<span class="token punctuation">.</span><span class="token constant">OPENID</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    event<span class="token punctuation">,</span>
    openid<span class="token operator">:</span> wxContext<span class="token punctuation">.</span><span class="token constant">OPENID</span><span class="token punctuation">,</span>
    appid<span class="token operator">:</span> wxContext<span class="token punctuation">.</span><span class="token constant">APPID</span><span class="token punctuation">,</span>
    unionid<span class="token operator">:</span> wxContext<span class="token punctuation">.</span><span class="token constant">UNIONID</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="云函数-getequipmentlist-云函数查询全部数据-云函数按条件查询数据库"><a href="#云函数-getequipmentlist-云函数查询全部数据-云函数按条件查询数据库" class="header-anchor">#</a> 云函数 &gt; getEquipmentList (云函数查询全部数据 , 云函数按条件查询数据库)</h4> <p>获取设备数据的时候存在多种情况</p> <p>获取全部数据: 由于获取数据库有100条上限的限制 , 需要进行特殊处理</p> <p>按条件查询数据 : 需要提前拼接好查询语句</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 云函数入口文件</span>
<span class="token keyword">const</span> cloud <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'wx-server-sdk'</span><span class="token punctuation">)</span>
cloud<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 云函数入口函数</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">main</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> wxContext <span class="token operator">=</span> cloud<span class="token punctuation">.</span><span class="token function">getWXContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 调用数据库获取所有设备列表</span>
  <span class="token keyword">const</span> db <span class="token operator">=</span> cloud<span class="token punctuation">.</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 获取数据库</span>
  <span class="token keyword">const</span> _ <span class="token operator">=</span> db<span class="token punctuation">.</span>command <span class="token comment">// 获取查询指令</span>
  <span class="token keyword">const</span> equipmentCollection <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'equipment'</span><span class="token punctuation">)</span> <span class="token comment">// 获取equipment集合</span>
  <span class="token comment">// 取所有集合中符合条件的数据(因为有默认 limit 100 条的限制,需要做特殊操作)</span>
  <span class="token keyword">const</span> <span class="token constant">MAX_LIMIT</span> <span class="token operator">=</span> <span class="token number">100</span>
  <span class="token comment">// 先取出集合记录总数</span>
  <span class="token keyword">const</span> countResult <span class="token operator">=</span> <span class="token keyword">await</span> equipmentCollection<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> total <span class="token operator">=</span> countResult<span class="token punctuation">.</span>total
  <span class="token comment">// 计算需分几次取</span>
  <span class="token keyword">const</span> batchTimes <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>total <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">)</span>
  <span class="token comment">// 承载所有读操作的 promise 的数组</span>
  <span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">let</span> query <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// 封装设备类型查询条件(直接通过reduce直接拼接方法)</span>
  query<span class="token punctuation">.</span>eq_type <span class="token operator">=</span> event<span class="token punctuation">.</span>queryList<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>acc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> _<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> acc<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>cur<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
  <span class="token comment">// 用户名查询条件</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>queryList<span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    query<span class="token punctuation">.</span>eq_user <span class="token operator">=</span> event<span class="token punctuation">.</span>queryList<span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> batchTimes<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> promise <span class="token operator">=</span> equipmentCollection<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token constant">MAX_LIMIT</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token constant">MAX_LIMIT</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    tasks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>promise<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 等待所有数据读取完成</span>
  <span class="token keyword">const</span> equipmentList <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>tasks<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    data<span class="token operator">:</span> acc<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span>
    errMsg<span class="token operator">:</span> acc<span class="token punctuation">.</span>errMsg<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    event<span class="token punctuation">,</span>
    data<span class="token operator">:</span> equipmentList<span class="token punctuation">,</span>
    openid<span class="token operator">:</span> wxContext<span class="token punctuation">.</span><span class="token constant">OPENID</span><span class="token punctuation">,</span>
    appid<span class="token operator">:</span> wxContext<span class="token punctuation">.</span><span class="token constant">APPID</span><span class="token punctuation">,</span>
    unionid<span class="token operator">:</span> wxContext<span class="token punctuation">.</span><span class="token constant">UNIONID</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="云函数-removeequipement-云函数删除集合数据"><a href="#云函数-removeequipement-云函数删除集合数据" class="header-anchor">#</a> 云函数 &gt; removeEquipement (云函数删除集合数据)</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 云函数入口文件</span>
<span class="token keyword">const</span> cloud <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'wx-server-sdk'</span><span class="token punctuation">)</span>

cloud<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 云函数入口函数</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">main</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> wxContext <span class="token operator">=</span> cloud<span class="token punctuation">.</span><span class="token function">getWXContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 调用数据库获取所有设备列表</span>
  <span class="token keyword">const</span> db <span class="token operator">=</span> cloud<span class="token punctuation">.</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 获取数据库</span>
  <span class="token keyword">const</span> _ <span class="token operator">=</span> db<span class="token punctuation">.</span>command <span class="token comment">// 获取查询指令</span>
  <span class="token keyword">const</span> equipmentCollection <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'equipment'</span><span class="token punctuation">)</span> <span class="token comment">// 获取equipment集合</span>
  
  <span class="token keyword">try</span><span class="token punctuation">{</span>
    <span class="token keyword">await</span> equipmentCollection<span class="token punctuation">.</span><span class="token function">doc</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    event<span class="token punctuation">,</span>
    openid<span class="token operator">:</span> wxContext<span class="token punctuation">.</span><span class="token constant">OPENID</span><span class="token punctuation">,</span>
    appid<span class="token operator">:</span> wxContext<span class="token punctuation">.</span><span class="token constant">APPID</span><span class="token punctuation">,</span>
    unionid<span class="token operator">:</span> wxContext<span class="token punctuation">.</span><span class="token constant">UNIONID</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>项目github地址: https://github.com/zhangyunsiyu/ingeektools
项目截图:</p> <p><img src="/assets/img/6.0b5d6a32.png" alt=""> <img src="/assets/img/7.7c30bd6e.png" alt=""> <img src="/assets/img/8.a70b0ed3.png" alt=""> <img src="/assets/img/9.c1b961b7.png" alt=""></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/miniApp/wechatApp/note.html" class="prev">
        《微信小程序实战笔记》
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a588af55.js" defer></script><script src="/assets/js/2.f38c671b.js" defer></script><script src="/assets/js/3.ec2fcfa1.js" defer></script>
  </body>
</html>
